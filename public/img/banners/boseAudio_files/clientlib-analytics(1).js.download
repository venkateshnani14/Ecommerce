var Bose=Bose||{};Bose.Analytics=function(){function a(){if("undefined"==typeof window||"function"!=typeof window.analyticstracker)return void window.console.error("Bose.Analytics: Script containing the analytics framework is not being loaded");try{l=window.analyticstracker(),b(),c(),d(),e(),f(),h(),g(),i(),j()}catch(a){window.console.error("Bose.Analytics: Script is not able to instantiate")}}function b(){Bose.Analytics.Page.init(l)}function c(){Bose.Analytics.Button.init(l)}function d(){Bose.Analytics.ContentBlock.init(l)}function e(){Bose.Analytics.Filter.init(l)}function f(){Bose.Analytics.Product.init()}function g(){Bose.Analytics.Form.init(l)}function h(){Bose.Analytics.Expandable.init(l)}function i(){l.trackImpression("product-detailimpression",{checkVisibility:!1}),l.trackImpression("product-subdetailimpression",{checkVisibility:!1}),l.trackImpression("product-purchaseimpression",{checkVisibility:!1,doCollect:!0}),l.trackImpression("button-impression"),l.trackImpression("contentblock-impression"),l.trackImpression("form-stepimpression"),l.trackImpression("filter-impression"),l.trackImpression("navigation-impression"),l.trackImpression("accordion-impression"),l.trackImpression("product-impression",{doCollect:!0}),setTimeout(i,500)}function j(){$jq(document).on("click","[data-tracking-event$=-click]",l.trackInteraction),Bose.Analytics.Form.eventHandlersForms(l)}function k(a,b){return{index:b+1||0,total:a.length}}var l;return{init:a,indexEvent:k,analyticsAttributes:{event:"data-tracking-event",info:"data-tracking-info",commerce:"data-tracking-commerce"}}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.Page=function(){function a(a){var d=Bose.Utils.getCategoryPathSegments(),e=window.performance.timing.domContentLoadedEventEnd-window.performance.timing.navigationStart,f=c(),g=b();a.trackImpression("page-impression",{addData:{info:{category:d[0],loadtime:e,variant:g,loggedin:f}}})}function b(){var a=Bose.Utils.getCurrentHref(),b=a.match("(?=bose-).*(?=.html)"),c="A";return null!==b&&(c=b[0]),c}function c(){var a=$jq(".gigya-api-key"),b="no";if(a.length){var c=a.val();c&&Bose.CookieStore.get("glt_"+c)&&(b="yes")}return b}return{init:a}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.Button=function(){function a(a){d=a,b(),c()}function b(){$jq(".productCallToActions .bose-cta.js-cta").not(".bose-cta--hide").each(function(){var a=$jq(this),b=a.find("a"),c=a.data("tracking-info");void 0===b.attr(Bose.Analytics.analyticsAttributes.info)&&void 0!==c&&b.attr(Bose.Analytics.analyticsAttributes.info,JSON.stringify(c))})}function c(){$jq(".bose-buttonLink__buyButton").not(".bose-cta--hide").on("click",function(){var a=$jq(this),b=a.data("tracking-info"),c=a.data("tracking-commerce"),e={event:"product-addtocart",info:b,commerce:c};d.trackEvent(e)})}var d;return{init:a}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.ContentBlock=function(){function a(a){c=a,$jq(document).on("analyticsHotspot",b)}function b(a,b,d,e){var f,g=$jq(e).data("info");f="open"===b?{clickStatus:"open"}:{clickStatus:"close"};var h=$jq.extend(g,f),i={event:"contentblock-click",info:h};c.trackEvent(i)}var c;return{init:a}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.Filter=function(){function a(a){e=a,$jq(document).on("analyticsUpdateFilter",b)}function b(a,b){var f=$jq(b),g=f.closest(".bose-productDrawer__container"),h=f.hasClass("bose-radioButton__input"),i=h?f.closest(".bose-radioButton"):f.closest(".bose-checkbox"),j=i.data("info")||"",k=h?$jq(".analytics-tracking__radio-"+j):$jq(".analytics-tracking__"+j),l=k.data("info")||"",m=c(i),n=d(j,h,g),o=$jq.extend(l,n,m),p={event:"filter-click",info:o};e.trackEvent(p)}function c(a){return"false"===a.attr("aria-checked")?{clickStatus:"check"}:{clickStatus:"uncheck"}}function d(a,b,c){var d,e=c.find(".bose-productDrawerFacet").not(".bose-radioButton__sortby"),f=c.find(".bose-radioButton__sortby"),g=[];return e.each(function(){var c=$jq(this),d=c.attr("aria-checked"),e=c.data("info"),f=c.hasClass("bose-radioButton");("true"===d&&b&&!f||"false"===d&&a===e||"true"===d&&!b)&&g.push(e)}),f.each(function(){var b=$jq(this),c=b.attr("aria-checked"),e=b.data("info"),f=b.data("info-label");e&&("true"===c||"false"===c&&a===e)&&(d=f)}),{result:g,sortby:d}}var e;return{init:a}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.Expandable=function(){function a(a){c=a,$jq(document).on("analyticsExpandableClick",b)}function b(a,b,d){var e,f=$jq(d),g=f.closest(".bose-expandableContentContainer"),h=g.data("tracking-info"),i=f.text();e=b?{clickStatus:"close",name:i.trim()}:{clickStatus:"open",name:i.trim()};var j=$jq.extend(h,e),k={event:"accordion-click",info:j};c.trackEvent(k)}var c;return{init:a}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.Product=function(){function a(){f=$jq(n.productTile2016),g=$jq(n.productTile2020),h=$jq(".productpage-tracking-analytics"),i=$jq(".subproductpage-tracking-analytics"),j=$jq(".bose-productPage"),k=$jq(".bose-productSubPageContainer"),b(f,"product-impression",l),b(g,"product-impression",l),b(h,"product-detailimpression",m),b(i,"product-subdetailimpression",m),$jq(document).on("analyticsUpdateProductTile",e)}function b(a,b,e){var f,g,h,i,j;f=e?a.filter(function(){return $jq(this).is(":visible")}):a,f.each(function(a){var k,l,m=$jq(this),n=m.data("accessory"),o=m.hasClass("bose-productTile2016"),p=m.hasClass("bose-productTile2020"),q=m.hasClass("bose-productTile2016--variantShop"),r=c(m,"a",n,o||p),s=m.data("commerce");q||"product-subdetailimpression"===b?(i=c(m,".bose-price__price",n,o||p),j=c(m,".js-bose-originalTotalPrice",n,o||p)):(i=c(m,".js-productPriceSummary__price",n,o||p),j=c(m,".bose-productPriceSummary__price--original",n,o||p)),s&&(k=i.data("price")||"",l=j.data("price")||"",k?(h=l?{price:l,discount:k}:{price:k},g=$jq.extend(s,h,Bose.Analytics.indexEvent(f,a))):g=$jq.extend(s,Bose.Analytics.indexEvent(f,a)),m.attr(Bose.Analytics.analyticsAttributes.event,b),m.attr(Bose.Analytics.analyticsAttributes.commerce,JSON.stringify(g)),e&&d(r,g))})}function c(a,b,c,d){var e=a.find(b);return d?e:(h.length?e=j.find(b):i.length&&!c&&(e=k.find(b)),e)}function d(a,b){a.each(function(){var a=$jq(this),c=a.attr("title")||"",d=a.attr("href")||"",e={linkTitle:c,linkUrl:d,source:c.length>0?c.toLowerCase():"clickthrough"},f=$jq.extend(b,e);a.hasClass("bose-productTile2020__colorIndicator2020")&&(f.color=a.attr("data-color-code")),a.hasClass("bose-productTile2020__secondChance")?(f.productintile=f.mainproduct,f.mainproduct=a.attr(Bose.Analytics.analyticsAttributes.info)?JSON.parse(a.attr(Bose.Analytics.analyticsAttributes.info)).name:""):a.attr(Bose.Analytics.analyticsAttributes.event,"product-click"),a.attr(Bose.Analytics.analyticsAttributes.commerce,JSON.stringify(f))})}function e(){b($jq(n.productTile2016),"product-impression",l),b($jq(n.productTile2020),"product-impression",l)}var f,g,h,i,j,k,l=!0,m=!1,n={productTile2016:".bose-productTile2016",productTile2020:".bose-productTile2020"};return{init:a,loadMoreProductTiles:e}}();
var Bose=Bose||{};Bose.Analytics=Bose.Analytics||{},Bose.Analytics.Form=function(){function a(a){q=a,r=$jq(t.form),b(r),$jq(document).on("analyticsFormError",i).on("analyticsFormFieldChange",j).on("analyticsFormFieldChangeCheckbox",k).on("analyticsFormFieldChangeSelect",l).on("analyticsFormStepComplete",n).on("analyticsFormLoadForm",c)}function b(a){a.each(function(){var a,b=$jq(this),c=b.find(t.boseForm),h=b.data("info")||"",i=b.closest(t.boseFormFlowPanel),j=i.length&&(i.is(u.checkoutStepEmail)||i.is(u.checkoutStepPayment)||i.is(u.checkoutStepReview)),k=i.data("info-stepnumber")||0,l=i.data("info-stepname")||"";h&&(a={name:h,stepnumber:k,stepname:l},c.attr(Bose.Analytics.analyticsAttributes.event,s.formStepImpression),c.attr(Bose.Analytics.analyticsAttributes.info,JSON.stringify(a)),b.attr(Bose.Analytics.analyticsAttributes.event,s.formStepComplete),b.attr(Bose.Analytics.analyticsAttributes.info,JSON.stringify(a)),d(b,a,b.find(t.textField)),d(b,a,b.find(t.textArea)),f(b,a,b.find(t.checkbox)),e(b,a,b.find(t.selectField)),j&&g(b,a))})}function c(){b($jq(t.form))}function d(a,b,c){c.each(function(a){var d=$jq(this);h(d.data("info")||"",b,d,c,a,s.formFieldFocus)})}function e(a,b,c){c.each(function(a){var d=$jq(this),e=d.find(".bose-select__native"),f=d.find(".bose-select__select"),g=d.data("info")||"";h(g,b,e,c,a,s.formFieldFocus),h(g,b,f,c,a,s.formFieldFocus)})}function f(a,b,c){c.each(function(a){var d=$jq(this),e=d.closest(".bose-checkbox"),f=d.data("info")||"";h(f,b,d,c,a,s.formFieldFocus),h(f,b,e,c,a,s.formFieldFocus)})}function g(a,b){var c,d,e=a.find(t.marketingPermissions),f=a.find(t.checkoutShippingOptions),g=a.find(t.checkoutShippingContainer),i=g.data("info")||"",j=a.find(t.paymentControlContainer);e.each(function(a){var c=$jq(this);h(c.data("info")||"",b,c,e,a,s.formFieldComplete)}),f.each(function(a){var c,d=$jq(this),e=d.val()||"";if(e){var g={result:e};c=$jq.extend(i,g)}else c=i;h(c,b,$jq(this),f,a,s.formFieldComplete)}),j.each(function(){var a=$jq(this);d=a.find(t.paymentControlOptions),c=a.data("info")||"",d.each(function(a){h(c,b,$jq(this),d,a,s.formFieldComplete)})})}function h(a,b,c,d,e,f){if(a){var g=$jq.extend(a,b,Bose.Analytics.indexEvent(d,e));c.attr(Bose.Analytics.analyticsAttributes.event,f),c.attr(Bose.Analytics.analyticsAttributes.info,JSON.stringify(g))}}function i(a,b,c){var d,e,f,g=$jq(b),h=g.data("info")||"",i=g.closest(t.form),j=i.data("info")||"";h&&(j?(e={name:j,message:c},d=$jq.extend(h,e)):d=h,f={event:s.formFieldError,info:d},q.trackEvent(f))}function j(a,b){var c,d,e,f=$jq(b),g=f.data("tracking-info")||"",h=f.val(),i=f.attr("name");(f.hasClass("ctHidden")||void 0===i||i.match("^(shipping)|(email)|(billing)|(payment)|(password)|(username)"))&&(h="XXXX"),m()&&g&&(d={result:h},e=$jq.extend(g,d),c={event:s.formFieldComplete,info:e},q.trackEvent(c))}function k(a,b){var c,d,e,f=$jq(b),g=f.data("tracking-info")||"",h=f.closest(".bose-checkbox"),i="false"===h.attr("aria-checked")?"false":"true";m()&&g&&(d={result:i},e=$jq.extend(g,d),c={event:s.formFieldComplete,info:e},q.trackEvent(c))}function l(a,b){var c,d,e,f=$jq(b),g=f.find(".bose-select__native"),h=g.data("tracking-info")||"",i=f.find(".ui-selectmenu-text"),j=i.text()||"";(g.hasClass("ctHidden")||g.attr("name").match("^(shipping)|(billing)|(payment)"))&&(j="XXXX"),m()&&h&&(d={result:j},e=$jq.extend(h,d),c={event:s.formFieldComplete,info:e},q.trackEvent(c))}function m(){var a=$jq(t.loadingOverlay),b=$jq(t.loadingButton);return a.length<1&&b.length<1}function n(a,b){var c;b?(c=b.target instanceof HTMLElement&&"checkout_customerdetails"===b.target.getAttribute("data-info"),q.trackInteraction(b,{collectFormData:c?[]:["all"]})):(c=a.target.forms&&"checkout_customerdetails"===a.target.forms[0].getAttribute("data-info"),q.trackInteraction(a,{collectFormData:c?[]:["all"]}))}function o(a){$jq(document).on("focus","[data-tracking-event=form-fieldfocus]",a.trackInteraction).on("focus",t.marketingPermissions,a.trackInteraction).on("focus",t.checkoutShippingOptions,a.trackInteraction).on("focus",t.paymentControlOptions,a.trackInteraction).on("submit","[data-tracking-event=form-stepcomplete]",p)}function p(a){n(a,a)}var q,r,s={formStepImpression:"form-stepimpression",formStepComplete:"form-stepcomplete",formFieldFocus:"form-fieldfocus",formFieldComplete:"form-fieldcomplete",formFieldError:"form-fielderror"},t={form:"form",boseForm:".bose-form",boseFormFlowPanel:".bose-formFlow__panel",textField:".bose-textField__input",selectField:".bose-select",textArea:".bose-textArea__input",checkbox:".bose-checkbox__input:not(.bose-checkbox__input--hidden)",marketingPermissions:".bose-marketingPermissions__radioContainer input",checkoutShippingContainer:".bose-checkoutShipping__row",checkoutShippingOptions:".bose-checkoutShipping__method__list input",paymentControlContainer:".bose-paymentGroup",paymentControlOptions:".bose-paymentGroup__radioGroup input",loadingOverlay:".bose-iconLoaderOverlay--wrapper",loadingButton:".bose-button--loading"},u={checkoutStepEmail:"#step_email",checkoutStepPayment:"#step_payment",checkoutStepReview:"#step_review"};return{init:a,eventHandlersForms:o,submitForm:p}}();
window.addEventListener("load",function(){Bose.Analytics.init()});
