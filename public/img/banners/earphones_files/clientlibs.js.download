var Bose=Bose||{};Bose.KlarnaBanner=function(){function a(){var a=$jq(i.variantDropdownSelector);g=$jq(i.klarnaPrequalify),a.val()?Bose.DataLayer.setVariable("Product","selectedVariantCode",a.val()):Bose.DataLayer.setVariable("Product","selectedVariantCode",$jq(i.productCode).val()),g.length&&($jq(document).on("variantChanged",b),void 0!==Bose.DataLayer.Data.Product&&void 0!==Bose.DataLayer.Data.Product.selectedVariantCode&&g.data("selected-variant",Bose.DataLayer.Data.Product.selectedVariantCode),c())}function b(b,c,d,f,j,k,l,m,n){return 0===$jq("klarna-placement").length?void a():n?(h=$jq(i.incentiveBundle).data("total-price"),void e()):void(g.data("selected-variant")!==d&&(g.data("selected-variant",d),e()))}function c(){var a,b=Math.round(100*f(g.data("selected-variant"))),c=$jq(i.klarnaBanner),e=c.data("klarnaUci"),h=c.data("klarnaDataid"),k=c.data("inline"),l=k?'data-inline="true"':"",m={},n=100*$jq(i.inputMinValue).val(),o=100*$jq(i.inputMaxValue).val();if(void 0!==window.KlarnaOnsiteService&&(window.KlarnaOnsiteService=[]),b<n||b>o)return void $jq(i.klarnaBanner).removeClass(j.show);if($jq(i.klarnaBanner).addClass(j.show),m.url=e,m.dataId=h,a='<script type="text/javascript" >(function(d,t) {"use strict"; var s = d.getElementsByTagName(t)[0], n = d.createElement(t); n.src = "{url}"; s.parentNode.insertBefore(n, s); }(document, "script")); <\/script> <klarna-placement data-id= "{dataId}"data-purchase_amount= "'+b+'" '+l+"></klarna-placement>",g.find(i.bannerMessage).html(nano(a,m)),window.MutationObserver){var p=new MutationObserver(function(){d()});$jq("klarna-placement").each(function(){p.observe(this,{attributes:!0,childList:!0})})}}function d(){g.removeClass("-showContentPlaceHolder")}function e(){var a=Math.round(100*f(g.data("selected-variant"))),b=100*$jq(i.inputMinValue).val(),c=100*$jq(i.inputMaxValue).val(),d=document.getElementsByTagName("klarna-placement")[0];if(a<b||a>c)return void $jq(i.klarnaBanner).removeClass(j.show);$jq(i.klarnaBanner).addClass(j.show),d.removeAttribute("data-purchase_amount"),d.setAttribute("data-purchase_amount",a),void 0!==window.KlarnaOnsiteService&&(window.KlarnaOnsiteService=window.KlarnaOnsiteService||[],window.KlarnaOnsiteService.push({eventName:"refresh-placements"}))}function f(a){var b="",c=$jq(i.priceContainer),d=c.data("priceProductcodemapping");return void 0===Bose.DataLayer.Data.Page||"productpage"!==Bose.DataLayer.Data.Page.type&&"productSubPage"!==Bose.DataLayer.Data.Page.type&&"contentpage"!==Bose.DataLayer.Data.Page.type&&"homepage"!==Bose.DataLayer.Data.Page.type&&"categorypage"!==Bose.DataLayer.Data.Page.type||void 0===d||void 0===a||void 0===d[a]||(b=d[a].originalPriceValue),h&&(b=h),b}var g,h,i={klarnaBanner:".bose-klarnaBanner",klarnaPrequalify:".js-bose-klarnaPrequalify",klarnaWidget:".js-boseKlarna-widget",incentiveBundle:".js-bose-incentiveBundles",language:".js-bose-locale",priceContainer:".bose-price",variantDropdownSelector:".bose-variantSelector__variants",inputMinValue:'input[name="klarnaMinimumValue"]',inputMaxValue:'input[name="klarnaMaximumValue"]',productCode:'input[name=":product-variantCode"]',bannerMessage:".bose-klarnaBanner__message"},j={show:"bose-klarnaBanner--show"};return{init:a,clearLoader:d,_selectors:i}}();
$jq(window).load(function(){Bose.KlarnaBanner.init()});
